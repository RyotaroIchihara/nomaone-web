---
import { getSiteData } from '../data/load';
import { formatAddress, formatPhoneForTel, formatPostalCode } from '../utils/format';
import { getAssetPath } from '../utils/paths';

const siteData = await getSiteData();
const { office, operations } = siteData;
const { legal_name, address, contacts } = office;

const footerLinks = [
  {
    title: 'サービス',
    items: [
      { href: getAssetPath('/services/#idou-shien'), text: '移動支援' },
      { href: getAssetPath('/services/#koudou-engou'), text: '行動援護' },
      { href: getAssetPath('/services/#tokutei-soudan'), text: '指定特定相談支援' },
    ],
  },
  {
    title: '情報',
    items: [
      { href: getAssetPath('/flow/'), text: '利用の流れ' },
      { href: getAssetPath('/company/'), text: '会社概要' },
      { href: getAssetPath('/recruit/'), text: '採用情報' },
      { href: getAssetPath('/contact/'), text: 'お問い合わせ' },
    ],
  },
];
---

<footer class="bg-gray-900 text-gray-300 mt-auto" aria-labelledby="footer-heading">
  <h2 id="footer-heading" class="sr-only">フッター</h2>
  <div class="container py-12 md:py-16">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
      <!-- 事業所情報 -->
      <div class="md:col-span-2">
        <div class="text-white font-bold mb-4">{legal_name}</div>
        <address class="not-italic text-sm space-y-2">
          <p>〒{formatPostalCode(address.postal_code)}</p>
          <p>{formatAddress(address.prefecture, address.city, address.street)}</p>
          <p>{address.access_note}</p>
          <div class="mt-4 space-y-1">
            <p>
              <span class="inline-block w-24">営業時間</span>
              {operations.office_hours}
            </p>
            <p>
              <span class="inline-block w-24">サービス時間</span>
              {operations.service_hours}
            </p>
          </div>
          <div class="mt-4">
            <a
              href={formatPhoneForTel(contacts.tel_fax)}
              class="inline-flex items-center text-white hover:text-gray-300"
            >
              <svg
                class="w-5 h-5 mr-2"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
              </svg>
              {contacts.tel_fax}
            </a>
          </div>
        </address>
      </div>

      <!-- サイトマップ -->
      {footerLinks.map(({ title, items }) => (
        <div>
          <h3 class="text-white font-medium mb-4">{title}</h3>
          <ul class="space-y-2">
            {items.map(({ href, text }) => (
              <li>
                <a
                  href={href}
                  class="text-sm hover:text-white transition-colors"
                >
                  {text}
                </a>
              </li>
            ))}
          </ul>
        </div>
      ))}
    </div>

    <!-- コピーライト -->
    <div class="mt-12 pt-8 border-t border-gray-800 text-sm text-center">
      <p>&copy; {new Date().getFullYear()} {legal_name}</p>
    </div>
  </div>
</footer>

<!-- モバイル固定CTA -->
<div class="md:hidden fixed bottom-0 left-0 right-0 bg-white shadow-lg border-t z-40">
  <div class="grid grid-cols-2 gap-1 p-2">
    <a
      href={getAssetPath('/contact/')}
      class="btn-primary text-sm py-2"
    >
      お問い合わせ
    </a>
    <a
      href={getAssetPath('/recruit/')}
      class="btn-secondary text-sm py-2"
    >
      ヘルパー登録
    </a>
  </div>
</div>
